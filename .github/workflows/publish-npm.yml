# name: Publish npm Packages

# on:
#   push:
#     tags:
#       - 'npm-v*'

# jobs:
#   publish:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4

#       - name: Setup Node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: '20'
#           registry-url: 'https://registry.npmjs.org'

#       - name: Setup pnpm
#         uses: pnpm/action-setup@v2
#         with:
#           version: 8

#       - name: Setup Rust
#         uses: dtolnay/rust-action@stable
#         with:
#           targets: wasm32-unknown-unknown

#       - name: Install wasm-pack
#         run: curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh

#       - name: Cache cargo
#         uses: actions/cache@v4
#         with:
#           path: |
#             ~/.cargo/bin/
#             ~/.cargo/registry/index/
#             ~/.cargo/registry/cache/
#             ~/.cargo/git/db/
#             target/
#           key: ${{ runner.os }}-cargo-wasm-${{ hashFiles('**/Cargo.lock') }}

#       - name: Install dependencies
#         working-directory: js
#         run: pnpm install

#       - name: Build packages
#         working-directory: js
#         run: pnpm build

#       - name: Verify version matches tag
#         working-directory: js/packages/core
#         run: |
#           TAG_VERSION=${GITHUB_REF#refs/tags/npm-v}
#           PKG_VERSION=$(node -p "require('./package.json').version")
#           if [ "$TAG_VERSION" != "$PKG_VERSION" ]; then
#             echo "Tag version ($TAG_VERSION) does not match package.json version ($PKG_VERSION)"
#             exit 1
#           fi

#       - name: Publish @cynos/core
#         working-directory: js/packages/core
#         env:
#           NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
#         run: pnpm publish --access public --no-git-checks
